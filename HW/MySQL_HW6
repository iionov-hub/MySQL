
-- Задание 3
-- Определить кто больше поставил лайков (всего) - мужчины или женщины?
SELECT p.gender , count(1) -- 52  мужчины больше поставили
FROM likes l,profiles p
WHERE l.user_id  = p.user_id
Group by p.gender ;

-- Задание 4
-- Подсчитать общее количество лайков десяти самым молодым пользователям (сколько лайков получили 10 самых молодых пользователей).
Select u.first_name , u.last_name ,
(Select TIMESTAMPDIFF(YEAR, birthday, NOW()) from profiles p2 where p2.user_id = u.id) as ag
from users u
where u.id  in (
Select l.target_id from likes l
where l.target_type_id  = 2)
order by ag LIMIT  10;


-- Задание 5

/*
Найти 10 пользователей, которые проявляют наименьшую активность в использовании социальной сети
(критерии активности необходимо определить самостоятельно).
 Кто вообще не лайкал других пользователей
 */

Select CONCAT(u.first_name,' ',u.last_name  ) as FIO
from users u
where u.id not in (
Select l.user_id from likes l
where l.target_type_id  = 2)
LIMIT  10;